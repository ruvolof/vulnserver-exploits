# VulnServer: LTER with SEH override and alpha-numeric shellcode

LTER command is vulnerable to a SEH buffer overflow.

The command accepts a sver restricted set of characters, forcing us to manually encode our payload.

The following scripts have been used to develop the full exploit:

1. lter_0poc.rb: just crash the service.
2. lter_1offsets.rb: sends a unique string to calculate offsets.
3. lter_2seh.rb: overrides SEH, but there's a bad character.
4. lter_3badchars.rb: sends all characters to determine badchars.
5. lter_4seh-good.rb: overrides SEH with a pointer to `pop pop ret`.
6. lter_5first-stage.rb: manually encoding a short jump back.
7. lter_6second-stage.rb: manually encoding a longer jump back and a pointer to our payload.
8. lter_7exploit.rb: full exploit with x86/alpha_mixed encoded payload.

The two jumps ca be compiled from the following files:

1. jmp-126.bin: encodes a short jump back of 126 bytes.
2. jmp-ecx.bin: points ecx about a 1000 bytes back and jumps to it.

A detailed blog post about the process of writing this exploit is available here:

[https://werebug.com/exploit/vulnserver/2019/11/15/vulnserver-lter-with-seh-override-and-alpha-numeric-shellcode.html](https://werebug.com/exploit/vulnserver/2019/11/15/vulnserver-lter-with-seh-override-and-alpha-numeric-shellcode.html)
