# KSTET exploit for Vulnserver

KSTET command is vulnerable to a stack based buffer overflow, the space available is very little. This problem has been solved by injecting the payload with a different command and using an egghunter to find it in memory.

The following scripts have been used to develop the full exploit:

1. kstet_0poc.rb: just crash the service.
2. kstet_1offsets.rb: sends a unique string to calculate offsets.
3. kstet_2eip.rb: overrides EIP and allows to check memory status after crash.
4. kstet_3buffer.rb: send a buffer with `STATS`, then crash the service.
5. kstet_4egghunter.rb: deploys and egghunter in the small space available after crash.
6. kstet_5exploit.rb: full exploit with payload.

A detailed blog post about the process of writing this exploit is available here:

[https://werebug.com/exploit/vulnserver/2019/11/07/vulnserver-developing-an-exploit-for-kstet.html](https://werebug.com/exploit/vulnserver/2019/11/07/vulnserver-developing-an-exploit-for-kstet.html)
