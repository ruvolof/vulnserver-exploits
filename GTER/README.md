# GTER exploit for Vulnserver

GTER command is vulnerable to a stack based buffer overflow. The available space for the payload is 147 bytes, not enough for a standard reverse shell. Therefore, a custom version of a reverse shell has been used, using only 120 bytes.

The following scripts have been used to develop the full exploit:

1. gter_0poc.py: just crash the service.
2. gter_1offsets.py: sends a unique string to calculate offsets.
3. gter_2eip.py: overrides EIP with a pointer to a `jmp esp`.
4. gter_3jmp.py: jumps from ESP to EAX after a small realignment.
5. gter_4connection.py: connects back to the attacker machine.
6. gter_5shell.py: spawns a shell on the connection.

The custom payload is composed by 3 call to system functions:

1. WSASocketA.bin: creates the socket.
2. connect.bin: connects back to the attacker machine.
3. CreateProcessA.bin: spawns a shell and redirects its IO channels.

These 3 files have been compiled separetely and pasted into the exploit.

A detailed blog post about the process of writing this exploit is available here:

[https://werebug.com/exploit/vulnserver/2019/11/11/vulnserver-developing-an-exploit-for-gter.html](https://werebug.com/exploit/vulnserver/2019/11/11/vulnserver-developing-an-exploit-for-gter.html)
